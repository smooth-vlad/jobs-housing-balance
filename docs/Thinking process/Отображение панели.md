
## root
### thinking
Поиск информации о создании UI панели для модов

Изучаем ресурсы UI

Я нашел несколько полезных ресурсов: на ReadTheDocs объясняется, как использовать ColossalFramework.UI, включая события и список компонентов. На Simtropolis и Reddit показан пример добавления UI компонентов, включая UIDragHandle. Информация о спрайтах полезна для кнопок и фонов панелей. Нужно уточнить имена фонов для панелей, например "GenericPanel".

Поиск информации о спрайте "GenericPanel" для UIPanel

Создаем главный UI-панель

У нас есть достаточно информации, чтобы создать UIPanel с титульной меткой и кнопкой закрытия. Стоит реализовать панель, наследующую от UIPanel, а не UIComponent, так как UIPanel имеет такие функции как backgroundSprite и padding. Добавим UILabel для титула, UIButton для кнопки закрытия и optionally UIDragHandle для перемещения.

Поиск спрайтов UI для кнопки закрытия

Реализация кнопки закрытия

Для кнопки закрытия не обязательно использовать заранее заданный спрайт. Можно использовать текст "×" или создать собственный спрайт. Моддеры обычно создают UIButton с текстом "×". Также можно использовать встроенный спрайт "buttonclose", если он есть в атласе "Ingame". Мы покажем пример с текстом и стилями.

Создаем панель UI с фоном и позиционированием

В документации упоминается использование backgroundSprite "GenericPanel". В методе Start устанавливаем его и настраиваем прозрачность. Также стоит привести пример с reddit для использования eventClick, а также указать на важность установки relativePosition для позиционирования. Можем облегчить расчет центровки через координаты родителя.

Реализация панели UI

Не стоит использовать виджеты UI, если это не принесет пользы, такие как составляющие для акций или новостей. Создадим класс `MainPanel : UIPanel` и в методе Start установим размер, фон и цвет. Для кнопки закрытия лучше использовать `relativePosition`, чтобы она корректно перемещалась при изменении размера панели.
### ответ
Вот «как обычно» это делают в CS1 на ColossalFramework.UI — коротко и по делу.

### Паттерн

- Наследуемся от **`UIPanel`** (удобнее, чем `UIComponent`, т.к. сразу есть фон, цвет, отступы). ([skylines-modding-docs.readthedocs.io](https://skylines-modding-docs.readthedocs.io/en/latest/modding/Development/How-to-Use-ColossalFramework.UI.html?utm_source=chatgpt.com "How to use ColossalFramework.UI"))
    
- Добавляем панель в корневой **`UIView.GetAView()`**, задаём **`backgroundSprite = "GenericPanel"`** и полупрозрачный цвет. ([skylines-modding-docs.readthedocs.io](https://skylines-modding-docs.readthedocs.io/en/latest/modding/Development/How-to-Use-ColossalFramework.UI.html?utm_source=chatgpt.com "How to use ColossalFramework.UI"))
    
- Внутрь кидаем `UILabel` (заголовок) и `UIButton` (крестик). Клик ловим через **`eventClick`**. ([skylines-modding-docs.readthedocs.io](https://skylines-modding-docs.readthedocs.io/en/latest/modding/Development/How-to-Use-ColossalFramework.UI.html?utm_source=chatgpt.com "How to use ColossalFramework.UI"))
    
- (Опционально) даём перетаскивание: `UIDragHandle` с `target = panel`. ([Reddit](https://www.reddit.com/r/CitiesSkylinesModding/comments/2ytrm1/tiny_code_snippet_how_to_use_colossalframeworkui/?utm_source=chatgpt.com "Tiny code snippet: how to use ColossalFramework.UI"))
    

---

### Минимальная реализация

```csharp
using ColossalFramework.UI;
using UnityEngine;

public sealed class MainPanel : UIPanel
{
    private UILabel _title;
    private UIButton _close;

    public override void Start()
    {
        base.Start();

        // Размер и фон панели
        size = new Vector2(300f, 400f);
        backgroundSprite = "GenericPanel";                 // встроенный дефолтный спрайт
        color = new Color32(0, 0, 0, 160);                 // полупрозрачный фон

        // Заголовок
        _title = AddUIComponent<UILabel>();
        _title.text = "Jobs-Housing Balance";
        _title.textScale = 1.1f;
        _title.autoSize = false;
        _title.width = width - 60f;
        _title.height = 24f;
        _title.relativePosition = new Vector2(12f, 8f);

        // Кнопка закрытия (крестик)
        _close = AddUIComponent<UIButton>();
        _close.text = "×";                                 // можно спрайт, но текст — самый надёжный и быстрый
        _close.normalBgSprite = "ButtonMenu";              // при желании можно подобрать другой из списка спрайтов
        _close.hoveredBgSprite = "ButtonMenuHovered";
        _close.pressedBgSprite = "ButtonMenuPressed";
        _close.size = new Vector2(28f, 24f);
        _close.relativePosition = new Vector2(width - _close.width - 8f, 6f);
        _close.eventClick += (_, __) => Hide();            // стандартно: просто прячем панель

        // Центрируем панель (можно заменить на своё позиционирование)
        CenterToParent();

        // (опционально) Перетаскивание панели за верхнюю «шапку»
        var drag = AddUIComponent<UIDragHandle>();
        drag.target = this;
        drag.relativePosition = Vector2.zero;
        drag.size = new Vector2(width, 32f);               // область, за которую тянем
        drag.BringToFront();
    }

    private void CenterToParent()
    {
        var ui = parent ?? UIView.GetAView();
        relativePosition = new Vector2(
            Mathf.Round((ui.width  - width)  / 2f),
            Mathf.Round((ui.height - height) / 2f)
        );
    }
}
```

Создание панели (например, в `LoadingExtensionBase.OnLevelLoaded`):

```csharp
using ICities;
using ColossalFramework.UI;

public class Loading : LoadingExtensionBase
{
    public override void OnLevelLoaded(LoadMode mode)
    {
        var view = UIView.GetAView();                      // корневой контейнер UI
        view.AddUIComponent<MainPanel>();                  // добавили нашу панель
    }
}
```

---

### Заметки по стилю и устойчивости

- **Спрайты/иконки.** Встроенные имена спрайтов можно подобрать из списков «UI Sprites» (там есть стандартные кнопки/фоновые панели). Если не уверены — оставьте текст «×» у кнопки закрытия, это самый простой и кросс-сетапный вариант. ([Cities: Skylines Modding Guide](https://citiesskylinesmoddingguide.readthedocs.io/en/latest/resources/UI-Sprites-4.html?utm_source=chatgpt.com "UI Sprites 4/8 - Cities:Skylines Modding's documentation"))
    
- **Обработчики кликов.** `eventClick` — штатный способ. Если планируется перетаскивание, гасите клик, если был реальный drag (порог в несколько пикселей). ([skylines-modding-docs.readthedocs.io](https://skylines-modding-docs.readthedocs.io/en/latest/modding/Development/How-to-Use-ColossalFramework.UI.html?utm_source=chatgpt.com "How to use ColossalFramework.UI"))
    
- **Почему `UIPanel`, а не `UIComponent`.** Документация и примеры показывают, что для «окна» удобнее сразу использовать `UIPanel`: меньше кода для фона/цвета, проще вкладывать элементы. ([skylines-modding-docs.readthedocs.io](https://skylines-modding-docs.readthedocs.io/en/latest/modding/Development/How-to-Use-ColossalFramework.UI.html?utm_source=chatgpt.com "How to use ColossalFramework.UI"))
    

Если хочешь — могу подогнать вариант под твою текущую иерархию (например, без центрирования, с якорями к углу, с сохранением позиции через `SavedFloat`, с собственной текстурой фона и кастомным атласом).